From d7d2f0f6d3859696efa43bd61d478e4b471aae18 Mon Sep 17 00:00:00 2001
From: Daniel Kudwien <daniel@netzstrategen.com>
Date: Mon, 25 Jan 2021 18:42:50 +0100
Subject: [PATCH] Fixed deprecation warning for $order::get_product_from_item()
 to be replaced by $item->get_product().

---
 includes/conditions/class-wc-csp-condition-cart-backorder.php   | 2 +-
 .../conditions/class-wc-csp-condition-cart-item-on-sale.php     | 2 +-
 .../conditions/class-wc-csp-condition-cart-shipping-class.php   | 2 +-
 .../conditions/class-wc-csp-condition-gift-card-product.php     | 2 +-
 4 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/includes/conditions/class-wc-csp-condition-cart-backorder.php b/includes/conditions/class-wc-csp-condition-cart-backorder.php
index 679d3ddf8..2a0138c81 100644
--- a/includes/conditions/class-wc-csp-condition-cart-backorder.php
+++ b/includes/conditions/class-wc-csp-condition-cart-backorder.php
@@ -80,7 +80,7 @@ class WC_CSP_Condition_Cart_Backorder extends WC_CSP_Condition {
 
 				foreach ( $order_items as $order_item ) {
 
-					$product = $order->get_product_from_item( $order_item );
+					$product = version_compare( WC_VERSION, '3.0', '<' ) ? $order->get_product_from_item( $order_item ) : $order_item->get_product();
 
 					if ( $product ) {
 
diff --git a/includes/conditions/class-wc-csp-condition-cart-item-on-sale.php b/includes/conditions/class-wc-csp-condition-cart-item-on-sale.php
index ba1fbfee3..88a81ffeb 100644
--- a/includes/conditions/class-wc-csp-condition-cart-item-on-sale.php
+++ b/includes/conditions/class-wc-csp-condition-cart-item-on-sale.php
@@ -81,7 +81,7 @@ class WC_CSP_Condition_Cart_Item_On_Sale extends WC_CSP_Condition {
 
 				foreach ( $order_items as $order_item ) {
 
-					$product = $order->get_product_from_item( $order_item );
+					$product = version_compare( WC_VERSION, '3.0', '<' ) ? $order->get_product_from_item( $order_item ) : $order_item->get_product();
 
 					if ( $product ) {
 
diff --git a/includes/conditions/class-wc-csp-condition-cart-shipping-class.php b/includes/conditions/class-wc-csp-condition-cart-shipping-class.php
index 43fd376d2..1f500bf48 100644
--- a/includes/conditions/class-wc-csp-condition-cart-shipping-class.php
+++ b/includes/conditions/class-wc-csp-condition-cart-shipping-class.php
@@ -133,7 +133,7 @@ class WC_CSP_Condition_Cart_Shipping_Class extends WC_CSP_Condition {
 
 				foreach ( $order_items as $order_item ) {
 
-					$product = $order->get_product_from_item( $order_item );
+					$product = version_compare( WC_VERSION, '3.0', '<' ) ? $order->get_product_from_item( $order_item ) : $order_item->get_product();
 
 					if ( $product ) {
 
diff --git a/includes/conditions/class-wc-csp-condition-gift-card-product.php b/includes/conditions/class-wc-csp-condition-gift-card-product.php
index d8f960112..14ac2c610 100644
--- a/includes/conditions/class-wc-csp-condition-gift-card-product.php
+++ b/includes/conditions/class-wc-csp-condition-gift-card-product.php
@@ -81,7 +81,7 @@ class WC_CSP_Condition_Gift_Card_Product extends WC_CSP_Condition {
 
 				foreach ( $order_items as $order_item ) {
 
-					$product = $order->get_product_from_item( $order_item );
+					$product = version_compare( WC_VERSION, '3.0', '<' ) ? $order->get_product_from_item( $order_item ) : $order_item->get_product();
 
 					if ( $product ) {
 
-- 
2.30.1

