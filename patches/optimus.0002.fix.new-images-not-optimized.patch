From 9a92aa45abf9bddce7fc257e06792aaf7fdd6eec Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Juli=C3=A0=20Mestieri?= <juli@netzstrategen.com>
Date: Wed, 22 May 2019 20:04:06 +0200
Subject: [PATCH] Fixed optimus not processing new images. (#308)

---
 inc/optimus_request.class.php | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/inc/optimus_request.class.php b/inc/optimus_request.class.php
index 43b8e268b..774494da6 100644
--- a/inc/optimus_request.class.php
+++ b/inc/optimus_request.class.php
@@ -177,7 +177,7 @@ class Optimus_Request
 
         /* Get all images from the attachment */
         $diff_filesizes = array();
-        $todo_files = self::_get_files($upload_data, $attachment_id);
+        list($todo_files, $mime_type) = self::_get_files($upload_data, $attachment_id);
 
         /* No images to process */
         if ( empty($todo_files) ) {
@@ -317,7 +317,7 @@ class Optimus_Request
        if ( empty( $metadata = wp_get_attachment_metadata( $post_id ) ) ) {
          return array();
        }
-       $files = self::_get_files($metadata, $post_id);
+       list($files, $mime_type) = self::_get_files($metadata, $post_id);
        $post_files = array();
 
        foreach( $files as $file ) {
@@ -403,7 +403,7 @@ class Optimus_Request
             $todo_files = array_reverse($todo_files);
         }
 
-        return $todo_files;
+        return array($todo_files, $mime_type);
     }
 
     /**
-- 
2.30.1

